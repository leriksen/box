%h2 Sign Up

= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f|
  = devise_error_messages!

  %div
    = f.label :email
    %br/
    = f.email_field :email, autofocus: true

  %div
    = f.label :password
    %br/
    = f.password_field :password

  %div
    = f.label :password_confirmation
    %br/
    = f.password_field :password_confirmation

  %div
    = f.label :roles
    - if no_users? # initial user gets all roles
      - User::ROLES.each do |role|
        - status = (role == 'customer' ? false : true)
        = check_box_tag "user[roles][]", role, status, disabled: true
        = h role.to_s.humanize
    - else
      - User::ROLES.each do |role|
        = check_box_tag "user[roles][]", role, @user.roles.include?(role)
        = h role.to_s.humanize
    = hidden_field_tag "user[roles][]"
    %br/

  %div
    = f.submit "Sign up"

  = render "devise/shared/links"
